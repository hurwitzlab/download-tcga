setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library(xlsx)
library("rJava", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("rJava")
setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library(xlsx)
library("rJava", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
detach("package:rJava", unload=TRUE)
remove.packages("rJava")
library("rJava", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("xlsx")
setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
install.packages("xml2")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("xlsx")
library(xlsx)
install.packages("xml2")
setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
install.packages("xml2")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("xlsx")
library(xlsx)
library("rJava", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
Sys.getenv("DYLD_FALLBACK_LIBRARY_PATH")
setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
install.packages("xml2")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
install.packages("xlsx")
library(xlsx)
install.packages("xml2")
setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
#install.packages("xml2")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
#install.packages("xlsx")
library(xlsx)
samples=as_list(read_xml("samples.xml"))
library(knitr)
opts_knit$set(root.dir ="~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
library(xlsx)
library(knitr)
opts_knit$set(root.dir ="~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
#setwd("~/Google Drive/Hurwitz Lab/Postdocking/PRJEB12449")
#install.packages("xml2")
library("xml2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
#install.packages("xlsx")
library(xlsx)
samples=as_list(read_xml("samples.xml"))
length(samples)
i=6
samples[i]$SAMPLE$SAMPLE_LINKS[3]$SAMPLE_LINK$XREF_LINK$ID[[1]]
temp1<-gsub("ERR","",samples[i]$SAMPLE$SAMPLE_LINKS[3]$SAMPLE_LINK$XREF_LINK$ID[[1]])
temp1
temp2<-strsplit(temp1,",")
temp2
readIds<-c(seq(temp3[[1]][[1]][1],temp3[[1]][[1]][2]),seq(temp3[[1]][[2]][1],temp3[[1]][[2]][2]))
f2<-function(x) strsplit(x,"-")
temp3<-lapply(temp2,f2)
temp3
readIds<-c(seq(temp3[[1]][[1]][1],temp3[[1]][[1]][2]),seq(temp3[[1]][[2]][1],temp3[[1]][[2]][2]))
readIds
i=1
sampleIds<-vector()
f2<-function(x) strsplit(x,"-")
sampleToReads<-data.frame("sampleName"=character(),"readId"=integer())
for(i in 1:length(samples)) {
x=strtrim(samples[i]$SAMPLE$IDENTIFIERS$SUBMITTER_ID[[1]],14)
sampleIds=c(sampleIds,x)
}
sampleIds
for(i in 1:length(samples)) {
temp1<-gsub("ERR","",samples[i]$SAMPLE$SAMPLE_LINKS[3]$SAMPLE_LINK$XREF_LINK$ID[[1]])
temp2<-strsplit(temp1,",")
temp3<-lapply(temp2,f2)
readIds<-c(seq(temp3[[1]][[1]][1],temp3[[1]][[1]][2]),seq(temp3[[1]][[2]][1],temp3[[1]][[2]][2]))
j=1
for(j in 1:length(readIds)) {
tempdf<-data.frame("sampleName"=sampleIds[i],"readId"=readIds[j])
sampleToReads<-rbind(tempdf,sampleToReads)
}
sampleToReads
metadata=read.xlsx2("metadata_2_NIH.xls")
metadata=read.xlsx2("metadata_2_NIH.xls",sheetIndex = 1)
View(metadata)
metadata=read.xlsx2("metadata_2_NIH.xls",sheetIndex = 1)
bigTable=merge(sampleToReads,metadata,by.x="sampleName",by.y="embl_id")
View(bigTable)
i=1
sampleIds<-vector()
f2<-function(x) strsplit(x,"-")
sampleToReads<-data.frame("sampleName"=character(),"readIndex"=integer())
for(i in 1:length(samples)) {
x=strtrim(samples[i]$SAMPLE$IDENTIFIERS$SUBMITTER_ID[[1]],14)
sampleIds=c(sampleIds,x)
}
sampleIds
for(i in 1:length(samples)) {
temp1<-gsub("ERR","",samples[i]$SAMPLE$SAMPLE_LINKS[3]$SAMPLE_LINK$XREF_LINK$ID[[1]])
temp2<-strsplit(temp1,",")
temp3<-lapply(temp2,f2)
readIndexs<-c(seq(temp3[[1]][[1]][1],temp3[[1]][[1]][2]),seq(temp3[[1]][[2]][1],temp3[[1]][[2]][2]))
j=1
for(j in 1:length(readIndexs)) {
tempdf<-data.frame("sampleName"=sampleIds[i],"readIndex"=readIndexs[j])
sampleToReads<-rbind(tempdf,sampleToReads)
}
sampleToReads
metadata=read.xlsx2("metadata_2_NIH.xls",sheetIndex = 1)
bigTable=merge(sampleToReads,metadata,by.x="sampleName",by.y="embl_id")
View(sampleToReads)
metadata=read.xlsx2("metadata_2_NIH.xls",sheetIndex = 1)
bigTable=merge(sampleToReads,metadata,by.x="sampleName",by.y="embl_id")
bigTable$readId=paste("ERR",bigTable$readIndex)
View(bigTable)
metadata=read.xlsx2("metadata_2_NIH.xls",sheetIndex = 1)
bigTable=merge(sampleToReads,metadata,by.x="sampleName",by.y="embl_id")
bigTable$readId=paste("ERR",bigTable$readIndex,sep="")
View(bigTable)
write.table(bigTable,file="metadata_to_readFileNames.txt",quote = FALSE,sep = "\t",row.names = FALSE,col.names = TRUE)
getcwd()
getwd()
